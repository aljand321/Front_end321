<!DOCTYPE >
<html >
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="icon" type="image/png" sizes="16x16" href="/images/gfu.png">
<title>Consulta externa</title>
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">

<link href="/css/font-awesome.css" rel="stylesheet" type="text/css" />
<link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
<link href="/css/animate.css" rel="stylesheet" type="text/css" />
<link href="/css/admin.css" rel="stylesheet" type="text/css" />
<link href="/css/jquerysctipttop.css" rel="stylesheet" type="text/css">
<link href="/plugins/kalendar/kalendar.css" rel="stylesheet">
<link rel="stylesheet" href="/plugins/scroll/nanoscroller.css">
<link href="/plugins/morris/morris.css" rel="stylesheet" />

<link rel="stylesheet" href="https://unpkg.com/vue-select@latest/dist/vue-select.css">
<link rel="stylesheet" href="/sweetalert2/dist/sweetalert2.min.css">
<style>
		div.a {
			text-align: center;
		}

		h1.letras {
			font: italic normal 400 16px/22px Arial, Verdana, Sans-serif;

		}
		.vertical-alignment-helper {
    	display:table;
    	height: 100%;
    	margin-left: 41%;
  	}
  	.vertical-align-center {
  	  /* To center vertically */
  	  display: table-cell;
  	  vertical-align: middle;
  	  text-align: center;
  	}
</style>
</head>
<body class="light_theme  fixed_header left_nav_fixed">
<div class="wrapper" id="filter">
    <!--\\\\\\\ wrapper Start \\\\\\-->
    <div class="header_bar">
      <!--\\\\\\\ header Start \\\\\\-->
      <div class="brand">
        <!--\\\\\\\ brand Start \\\\\\-->
          <div class="logo" style="display:block"><span class="theme_color">Hospital</div>
            
      </div>
      <!--\\\\\\\ brand end \\\\\\-->
      <div class="header_top_bar">
          <!--\\\\\\\ header top bar start \\\\\\-->
          <a href="javascript:void(0);" class="menutoggle"> <i class="fa fa-bars"></i> </a>

          <div class="top_right_bar">

              <div class="user_admin dropdown"> <a href="javascript:void(0);" data-toggle="dropdown">
                <img src="/images/medico.png" /><span class="user_adminname"> <span>&nbsp;&nbsp;</span> <%=data_doc.data.medico.nombre%> <%=data_doc.data.medico.apellidop%></span> <b class="caret"></b> </a>
                <ul class="dropdown-menu">
                    <div class="top_pointer"></div>
                    <li> <a href="javascript:void(0);"data-target="#myModalCerrar" data-toggle="modal"><i class="fa fa-power-off"></i> Salir</a> </li>
                </ul>
              </div> 
          </div>
      </div>
      <!--\\\\\\\ header top bar end \\\\\\-->
    </div>
    <!--\\\\\\\ header end \\\\\\-->
    <div class="inner">
      <!--\\\\\\\ inner start \\\\\\-->
        <div class="left_nav">
          <!--\\\\\\\left_nav start \\\\\\-->          
            <div class="left_nav_slidebar">
                <ul>
                    <li><a href="/consulta_externa/home/<%=data_doc.data.token_id%>/<%=data_doc.data.token_p%>"><i class="fa fa-home"></i> Inicio <span class="plus"><i class="fa fa-plus"></i></span> </a></li>
                    <li > <a href="javascript:void(0);"> <i class="fa fa-tasks"></i> Consulta Externa<span class="plus"><i class="fa fa-plus"></i></span></a>
                        <ul >
                            <li> <a href="/consulta_externa/lista_pacientes/<%=data_doc.data.token_id%>/<%=data_doc.data.token_p%>"> <span>&nbsp;</span> <i class="fa fa-circle"></i> <b class="">Listas de Consultas</b></a> </li>
                        </ul>
                    </li>
                    <li class="left_nav_active theme_border"> <a href="javascript:void(0);"> <i class="fa fa-folder-open-o"></i> Reportes <span class="left_nav_pointer"></span> <span class="plus"><i class="fa fa-plus"></i></span></a>
                        <ul class="opened" style="display:block">
                            <li> <a href="/consulta_externa/pacietnes_atendidos/<%=data_doc.data.token_id%>/<%=data_doc.data.token_p%>"> <span>&nbsp;</span> <i class="fa fa-circle"></i> <b class="theme_color">Pacientes atendidos</b>  </a> </li>
							<li> <a href="/consulta_externa/pacietnes_no_atendidos/<%=data_doc.data.token_id%>/<%=data_doc.data.token_p%>"> <span>&nbsp;</span> <i class="fa fa-circle"></i> <b  >No atendidos</b>  </a> </li>
							<li> <a href="/consulta_externa/historial_clinico/<%=data_doc.data.token_id%>/<%=data_doc.data.token_p%>"> <span>&nbsp;</span> <i class="fa fa-circle"></i> <b >Historial Clinico </b>  </a> </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        <!--\\\\\\\left_nav end \\\\\\-->
        <div class="contentpanel">
            <!--\\\\\\\ contentpanel start\\\\\\-->
            <div class="container clear_both padding_fix col-lg-8">     
                <br>
                <div class="row">
                    <div class="col-md-14">
                        <div class="col-lg-12 block-web"> 
        	            	<div class="header">
        	            		<div class="info blue_symbols "> <i class="fa fa-ambulance icon "></i></div>
        	            		<h3 class="content-header "><span>&nbsp;&nbsp;&nbsp;</span>Consulta Externa</h3>
                            </div>  
                            <br>
                            <br>
                           
                            <div class="col-md-14">
                                <div data-date-format="mm/dd/yyyy" data-date="13/07/2013" class="input-group input-large">
                                    <input v-model="fecha_inicio" type="date" name="from" class="form-control dpd1">
                                    <span class="input-group-addon">A</span>
                                    <input v-model="fecha_final" type="date" name="to" class="form-control dpd2">
                                </div>
                                <span class="help-block">Selecione rango</span>
                            </div>
                            <div class="col-md-4">
                                <div class="row">
                                    <v-select :options="lista_paciente" label="name" v-model="historial" placeholder="Nombre Paciente"></v-select>                                                                   
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="row">
                                    <p class="text-center">
                                        <button @click="buscar()" type="button" value="Imprimir"  class="btn btn-success"><i class="zmdi zmdi-print"></i> &nbsp;&nbsp; Buscar</button>
                                        <button @click="list_paciente_f =''" type="button" value="Imprimir"  class="btn btn-success"><i class="zmdi zmdi-print"></i> &nbsp;&nbsp; volver</button>
                                    </p>
                                </div>
                            </div>            
                        </div>
                       
                        <!-- 
                            <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
                            <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
                                        tabla de citas del paciente
                            <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
                            <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
                         -->

                        
                        <template v-if="list_paciente_f != ''">
                            <div class="row">
                                <div class="col-lg-12">
                                    <section class="panel default blue_title h2">
                                         
                                        <div class="panel-body">
                                            <div class="table-responsive">
                                                <table class="table table-bordered">
                                                    <thead>
                                                        <tr>
                                                           <th class="text-center">#</th>
                                                           <th class="" WIDTH="15%">NÂ° de historia </th>
                                                           <th class="" WIDTH="20%">Nombre del Paciente</th>
                                                           <th class="" WIDTH="20%">Apellido paterno</th>
                                                           <th class="" WIDTH="20%">Apellido materno</th>	
                                                           <th class="" WIDTH="20%">Fecha Ingreso</th>	
                                                           <th class="" WIDTH="20%">Estado</th>	
                                                          
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="(list, index) in list_paciente_f">
                                                            <td>{{index+1}}</td>
                                                            <td>{{list.codigo_p}}</td>
                                                            <td>{{list.Paciente.nombre}}</td>
                                                            <td>{{list.Paciente.apellidop}}</td>
                                                            <td>{{list.Paciente.apellidom}}</td>
                                                            <td>{{list.fecha}}</td>
                                                            <td v-if = "list.estado_atendido == true"><p style="color: green;">Atendido</p></td>
                                                           
                                                        </tr>
                                                    
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </section>
                                </div>
                            </div>
                        </template>
                        <template v-else >
                            <div class="col-lg-12">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="block-web">
                                            <div class="header">
                                                <div class="actions"> <a class="minimize" href="#"><i class="fa fa-chevron-down"></i></a> <a class="refresh" href="#"><i class="fa fa-repeat"></i></a> <a class="close-down" href="#"><i class="fa fa-times"></i></a> </div>
                                                <h3 class="content-header">Data Table</h3>
                                            </div>
                                            <div class="porlets-content">
                                                <div class="table-responsive">
                                                    <table  class="display table table-bordered table-striped" id="dynamic-table">
                                                        <thead>
                                                            <tr>
                                                               <th>#</th>
                                                               <th>NÂ° Historial</th>
                                                               <th>Nombre Paciente</th>
                                                               <th>Apellido Paterno</th>
                                                               <th>Apellido Materno</th>
                                                               <th>Fecha de Atencion</th>
                                                               <th>Estado</th>	                                                             
                                                             
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <%for (var i = 0; i < citas.length; i++) { %>
                                                                <tr>
                                                                    <td><%=i+1%></td>
                                                                    <td><%=citas[i].codigo_p%></td>
                                                                    <td><%=citas[i].Paciente.nombre%></td>
                                                                    <td><%=citas[i].Paciente.apellidop%></td>
                                                                    <td><%=citas[i].Paciente.apellidom%></td>
                                                                    <td><%=citas[i].fecha%></td>
                                                                    <%if  (citas[i].estado_atendido == true) { %>
                                                                        <td><p style="color: green;">Atendido</p></td>
                                                                    <% } %>
                                                                </tr>
                                                            <% } %>
                                                                                           
                                                        </tbody>
                                                        <tfoot>
                                                            <tr>
                                                                <th>#</th>
                                                                <th>NÂ° Historial</th>
                                                                <th>Nombre Paciente</th>
                                                                <th>Apellido Paterno</th>
                                                                <th>Apellido Materno</th>
                                                                <th>Fecha de Atencion</th>
                                                                <th>Estado</th>	   
                                                               
                                                            </tr>
                                                        </tfoot>
                                                    </table>
                                                </div><!--/table-responsive-->
                                            </div><!--/porlets-content-->                               
                                        
                                        </div><!--/block-web--> 
                                    </div><!--/col-md-12--> 
                                </div><!--/row-->
                            </div>
                        </template>
                    </div>
                </div>
                <!--\\\\\\\ container  end \\\\\\-->
            </div>
            <!--\\\\\\\ content panel end \\\\\\-->
        </div>
        <!--\\\\\\\ inner end\\\\\\-->
    </div>
</div>
<!--\\\\\\\ wrapper end\\\\\\-->
<div class="modal fade" id="myModalCerrar" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    
	<div class="vertical-alignment-helper">
	  <div class="modal-dialog vertical-align-center modal-sm ">
		<div class="modal-content">
		  <br>
			<div class="center">
			  <i><img src="/images/salir.gif" width="100" height="100" /></i>
			</div>
			<div class="center">
			  <h5><b>Â¿Cerrar SesiÃ³n?</b></h5>
			</div>
		  <div class="modal-footer">
			<div class="center">
			  <a href="/delete_token/<%=data_doc.data.token_id%>" class="btn btn-success"><i class="fa fa-check"></i><span>&nbsp;</span>SÃ­, Confirmar</a>
			  <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i><span>&nbsp;</span>No, Cancelar</button>
			</div>
		  </div>
		</div>
	  </div>
	</div> 
</div>
<script src="/js/jquery-2.1.0.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/common-script.js"></script>
<script src="/js/jquery.slimscroll.min.js"></script>
<script src="/plugins/data-tables/jquery.dataTables.js"></script>
<script src="/plugins/data-tables/DT_bootstrap.js"></script>
<script src="/plugins/data-tables/dynamic_table_init.js"></script>
<script src="/plugins/edit-table/edit-table.js"></script>
<script>
          jQuery(document).ready(function() {
              EditableTable.init();
          });
 </script>

<script src="https://unpkg.com/vue@latest"></script>
<script src="https://unpkg.com/vue-select@latest"></script>

<script src="/js/jPushMenu.js"></script> 
<script src="/js/side-chats.js"></script>

<script src="/sweetalert2/dist/sweetalert2.min.js"></script>

<script src="/moment/moment.js"></script>
<script src="/moment/locale/af.js"></script>
<script src="/url/export.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.10/dist/vue.js"></script>
<script src="/axios/dist/axios.min.js"></script>

<script>
    Vue.component('v-select', VueSelect.VueSelect)
    var id_medico = "<%=id_medico%>"
     const filter = new Vue({        
        el:"#filter",
        data:() => ({
            url:data_url.url_front_end,
            id_m:id_medico,
            lista_paciente:[],
            historial:'',
            fecha_inicio:'',
            fecha_final:'',
            list_paciente_f:''
        }),
        mounted(){

            fetch(this.url+'/internaciones/Vue_Paciente_all')
            .then(res => res.json())
            .then(data => { 
                console.log(data, "   33333333333")
                for (var i = 0; i < data.length; i++){
                    this.lista_paciente.push({
                        name: data[i].nombre+' '+data[i].apellidop+' '+data[i].apellidom,
                        historial: data[i].numeroHistorial                        
                    })
                }                
            })
        },
        methods:{
            buscar(){
                var data_body = {
                    historial: this.historial.historial,
                    fecha_inicio: this.fecha_inicio,
                    fecha_final: this.fecha_final
                };
                var esto = {
                    method: 'POST',
                    body: JSON.stringify(data_body),
                    headers:{
                      'Content-type' : "application/json"
                    }
                };
                fetch(this.url+'/consulta_externa/Vue_pacientes_atendidos/'+this.id_m, esto)
                .then(res => res.json())
                .catch(error => console.error('Error:', error))
                .then(data => {
                    if (data.success == false){
                        swal.fire(
                          'Error!',
                          '<label style="color:red;">'+data.msg+'</label>',
                          'error'
                        )
                    }else{
                        this.list_paciente_f = data
                    } 
                    console.log(data, " esto es le mensaje que quiero ver")       
                })
            }
        }
     })
     
     
</script>

</body>
</html>
