<!DOCTYPE html>
<html lang="es">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Pacientes para Internar</title>
    <meta charset="UTF-8">
    <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">

    <link href="/css/font-awesome.css" rel="stylesheet" type="text/css" />
    <link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="/css/animate.css" rel="stylesheet" type="text/css" />
    <link href="/css/admin.css" rel="stylesheet" type="text/css" />
    <link href="/plugins/data-tables/DT_bootstrap.css" rel="stylesheet">
    <link href="/plugins/advanced-datatable/css/demo_table.css" rel="stylesheet">
    <link href="/plugins/advanced-datatable/css/demo_page.css" rel="stylesheet">

    <link href="/plugins/toggle-switch/toggles.css" rel="stylesheet" type="text/css" />
    <link href="/plugins/checkbox/icheck.css" rel="stylesheet" type="text/css" />
    <link href="/plugins/checkbox/minimal/blue.css" rel="stylesheet" type="text/css" />
    <link href="/plugins/checkbox/minimal/green.css" rel="stylesheet" type="text/css" />
    <link href="/plugins/checkbox/minimal/grey.css" rel="stylesheet" type="text/css" />
    <link href="/plugins/checkbox/minimal/orange.css" rel="stylesheet" type="text/css" />
    <link href="/plugins/checkbox/minimal/pink.css" rel="stylesheet" type="text/css" />
    <link href="/plugins/checkbox/minimal/purple.css" rel="stylesheet" type="text/css" />
    <link href="/plugins/bootstrap-fileupload/bootstrap-fileupload.min.css" rel="stylesheet">
    <link href="/plugins/dropzone/dropzone.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/plugins/bootstrap-datepicker/css/datepicker.css" />
    <link rel="stylesheet" type="text/css" href="/plugins/bootstrap-timepicker/compiled/timepicker.css" />
    <link rel="stylesheet" type="text/css" href="/plugins/bootstrap-colorpicker/css/colorpicker.css" />

    <link rel="stylesheet" href="https://unpkg.com/vue-select@latest/dist/vue-select.css">
    <link rel="stylesheet" href="/sweetalert2/dist/sweetalert2.min.css">

    <style>
        div.a {
            text-align: center;
        }

        h1.letras {
            font: italic normal 400 16px/22px Arial, Verdana, Sans-serif;

        }
        .vertical-alignment-helper {
        	display:table;
        	height: 100%;
        	margin-left: 41%;
        }
        .vertical-align-center {
        	/* To center vertically */
        	display: table-cell;
        	vertical-align: middle;
        	text-align: center;
        }
    </style>
    <%- include("../partials/head") -%>
    <script type="text/javascript">
        // este scrip es para verificar si esta el token en local starge
        var data = localStorage.getItem('data')
        console.log(data)
        if (data == null){
            window.location.replace('/')
        }
        function delete_local_storage(){
	    	console.log ("ssss")
	    	localStorage.removeItem('data');
	    	localStorage.removeItem('url');
  	    }
  	    setTimeout(()=>{
  	      delete_local_storage()
  	      //window.location.replace('/')
  	    },500000);
    </script>
</head>
<body class=" light_theme  fixed_header left_nav_fixed" >
	<div class="wrapper" id = "Fechas">
        <div class="header_bar">
            <div class="brand">
                <div class="logo" style="display:block"><span class="theme_color">Hospital</div>
            </div>
            <div class="header_top_bar">
                <a href="javascript:void(0);" class="menutoggle"> <i class="fa fa-bars"></i> </a>

                <div class="top_right_bar">

                    <div class="user_admin dropdown"> <a href="javascript:void(0);" data-toggle="dropdown"><img
                                src="/images/medico.png" /><span class="user_adminname">  <span>&nbsp;&nbsp;</span>  <%=data_doc.data.medico.nombre%> <%=data_doc.data.medico.apellidop%></span> <b
                                class="caret"></b> </a>
                        <ul class="dropdown-menu">
                            <div class="top_pointer"></div>
                            <li> <a href="javascript:void(0);" data-target="#myModalCerrar" data-toggle="modal" ><i class="fa fa-power-off"></i> Salir</a> </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="inner">
            <div class="left_nav">
                <div class="left_nav_slidebar">
					<ul>
						<li ><a href="javascript:void(0);"><i
							class="fa fa-home"></i> Home  <span
							class="plus"><i class="fa fa-plus"></i></span> </a>
							<ul > 
								<li> <a href="/internaciones/home/<%=data_doc.data.token_id%>"> <span>&nbsp;</span> <i class="fa fa-circle "></i> <b ><%=data_doc.data.area_esp.nombre%></b>
								</a> </li>
							</ul>
						</li>
						
							<li class="left_nav_active theme_border"> <a href="javascript:void(0);"> <i class="fa fa-tasks"></i> Lista de Paciente <span class="left_nav_pointer"></span> <span
										class="plus"><i class="fa fa-plus"></i></span></a>
								<ul  class="opened" style="display:block">
									<li> <a href="/internaciones/ListaInternacionF/<%=data_doc.data.area_esp.id%>/<%=data_doc.data.token_id%>"> <span>&nbsp;</span> <i class="fa fa-circle theme_color"></i>
										<b >Listas de Internación</b>
                                        </a> 
                                    </li>
                                    <li> <a href="/internaciones/list_internadios/<%=data_doc.data.area_esp.id%>/<%=data_doc.data.token_id%>"> <span>&nbsp;</span> <i class="fa fa-circle theme_color"></i>
                                        <b >Pacientes Internados</b>
                                        </a> 
                                    </li>
                                    <li> <a href="#"> <span>&nbsp;</span> <i class="fa fa-circle theme_color"></i>
                                        <b class="theme_color">Pacientes de alta </b>
                                        </a> 
                                    </li>
                                    <li> <a href="/internaciones/lista_traslados/<%=data_doc.data.area_esp.id%>/<%=data_doc.data.token_id%>" > <span>&nbsp;</span> <i class="fa fa-circle"></i>
										<b >Traslados</b>
								    	</a> 
								    </li>
	
								</ul>
							</li>
					</ul>
				</div>
            </div>
            <div class="contentpanel">
                <div class="container clear_both padding_fix col-lg-8">
                    <br>
                    <div class="main-content">
	                    <!--Listas de Emergencias-->
	                    <div class="container-fluid">
	                    	<div class="row">
	                    		<div class="col-md-12 block-web">
                                    <!-- Content page -->
                                    <div class="header">
                                        <div class="info blue_symbols "> <i class="fa fa-medkit icon "></i></div>
                                        <h3 class="content-header "><span>&nbsp;&nbsp;&nbsp;</span>Pacientes Internados</h3>
                                
                                        <!-- PAcientes no Atendidos-->
                                        <br>
                                        <br>
                                        
                                        <br>
                                       
                                        <div class="col-md-14">
                                            <div data-date-format="mm/dd/yyyy" data-date="13/07/2013" class="input-group input-large">
                                                <input v-model="fecha_inicio" type="date" name="from" class="form-control dpd1">
                                                <span class="input-group-addon">A</span>
                                                <input v-model="fecha_final" type="date" name="to" class="form-control dpd2">
                                            </div>
                                            <span class="help-block">Selecione rango</span>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="row">
                                                <v-select :options="lista_paciente" label="name" v-model="historial" placeholder="Nombre Paciente"></v-select>
                                               <!--  <select name="" id="" class="form-control">
                                                    <option value="">asd</option>
                                                </select> -->
                                                
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="row">
                                                <p class="text-center">
                                                    <button @click="buscar()" type="button" value="Imprimir"  class="btn btn-success"><i class="zmdi zmdi-print"></i> &nbsp;&nbsp; Buscar</button>
                                                    <button @click="list_paciente_f =''" type="button" value="Imprimir"  class="btn btn-success"><i class="zmdi zmdi-print"></i> &nbsp;&nbsp; volver</button>
                                                </p>
                                            </div>
                                        </div>
	                                	<template v-if="list_paciente_f != ''">
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <section class="panel default blue_title h2">
                                                         
                                                        <div class="panel-body">
                                                            <div class="table-responsive">
                                                                <table class="table table-bordered">
                                                                    <thead>
                                                                        <tr>
                                                                           <th class="text-center">#</th>
                                                                           <th class="" WIDTH="15%">N° de historia </th>
                                                                           <th class="" WIDTH="20%">Nombre del Paciente</th>
                                                                           <th class="" WIDTH="20%">Apellido paterno</th>
                                                                           <th class="" WIDTH="20%">Apellido materno</th>	
                                                                           <th class="" WIDTH="20%">Fecha Ingreso</th>	
                                                                           <th class="text-center" WIDTH="20%">Opciones</th> 
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <tr v-for="(list, index) in list_paciente_f">
                                                                            <td>{{index+1}}</td>
                                                                            <td>{{list.historial}}</td>
                                                                            <td>{{list.Paciente.nombre}}</td>
                                                                            <td>{{list.Paciente.apellidop}}</td>
                                                                            <td>{{list.Paciente.apellidom}}</td>
                                                                            <td>{{list.fechaIngreso}}</td>
                                                                            <td class="text-center" ><a :href="'/internaciones/paciente_internacion/' +list.id+'/<%=data_doc.data.token_id%>'" data-toggle="tooltip" class="btn  tooltips" ><i class="fa fa-pencil-square-o" style="color:green"></i></a></td>

                                                                        </tr>
                                                                      
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </section>
                                                </div>
                                            </div>

                                        </template>
                                        <template v-else>
                                                <div class="table-responsive" >
                                                        <table class="fl-table display table table-bordered table-striped" id="dynamic-tablee">
                                                            <thead>
                                                                  <tr>
                                                                    <th class="text-center">#</th>
                                                                    <th class="" WIDTH="15%">N° de historia </th>
                                                                    <th class="" WIDTH="20%">Nombre del Paciente</th>
                                                                    <th class="" WIDTH="20%">Apellido paterno</th>
                                                                    <th class="" WIDTH="20%">Apellido materno</th>	
                                                                    <th class="" WIDTH="20%">Fecha Ingreso</th>	
                                                                    <th class="text-center" WIDTH="20%">Opciones</th> 
                                                                  </tr>
                                                            </thead>
                                                            <tbody>
                                                            
                                                                <%for(var i = 0; i< list_internacion.length; i++) { %>
                                                                    <tr>
                                                                        <td><%=i+1%></td>
                                                                        <td><%=list_internacion[i].historial%></td>
                                                                        <td><%=list_internacion[i].Paciente.nombre%></td>
                                                                        <td><%=list_internacion[i].Paciente.apellidop%></td>
                                                                        <td><%=list_internacion[i].Paciente.apellidom%></td>
                                                                        <td><%=list_internacion[i].fechaIngreso%></td>
                                                                        <td class="text-center" ><a href="/internaciones/paciente_internacion/<%=list_internacion[i].id%>/<%=data_doc.data.token_id%>" data-toggle="tooltip" class="btn  tooltips" ><i class="fa fa-pencil-square-o" style="color:green"></i></a></td>
                                                                    
                                                                    </tr>
                                                                <% } %>
                                                                
                                                            </tbody>
                                                        </table>
                                                    </div>
                                        </template>
	                                	
	                                </div>
                                
	                    	    </div>
	                        </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
	</div>
	<!--====== Scripts -->
	<div class="modal fade" id="myModalCerrar" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">

        <div class="vertical-alignment-helper">
          <div class="modal-dialog vertical-align-center modal-sm ">
              <div class="modal-content">
                <br>
                <div class="center">
                  <i><img src="/images/salir.gif" width="100" height="100" /></i>
                </div>
                <div class="center">
                  <h5><b>¿Cerrar Sesión?</b></h5>
                </div>
                <div class="modal-footer">
                    <div class="center">
                      <a href="/delete_token/<%=data_doc.data.token_id%>" onclick="delete_local_storage()" class="btn btn-success"><i class="fa fa-check"></i><span>&nbsp;</span>Sí, Confirmar</a>
                      <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i><span>&nbsp;</span>No, Cancelar</button>
                    </div>
                </div>
              </div>
          </div>
        </div> 
    </div>	
	<script src="/js/get/consultaget.js"></script>	
	
	<script src="/js/get/consultaget.js"></script>


    <script src="/js/jquery-2.1.0.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/common-script.js"></script>
    <script src="/js/jquery.slimscroll.min.js"></script>

    <script src="/plugins/data-tables/jquery.dataTables.js"></script>
    <script src="/plugins/data-tables/DT_bootstrap.js"></script>
	<script src="/plugins/data-tables/dynamic_table_init.js"></script>
	<script src="/plugins/data-tables/dynamic_table_init2.js"></script>
    <script src="/plugins/edit-table/edit-table.js"></script>
    <script>
        jQuery(document).ready(function () {
            EditableTable.init();
        });
    </script>
    
    <script src="https://unpkg.com/vue@latest"></script>
    <script src="https://unpkg.com/vue-select@latest"></script>


    <script src="/js/jPushMenu.js"></script>
    <script src="/js/side-chats.js"></script>

    <script src="/sweetalert2/dist/sweetalert2.min.js"></script>

    <script src="/moment/moment.js"></script>
    <script src="/moment/locale/af.js"></script>
    <script src="/url/export.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.10/dist/vue.js"></script>
    <script src="/axios/dist/axios.min.js"></script>
    <script>
        Vue.component('v-select', VueSelect.VueSelect)
        var id_esp = "<%=id_especialidad%>"
        const Fechas = new Vue({        
            el:"#Fechas",
            data:() => ({
                url:data_url.url_front_end,
                data: "aljand321",
                lista_paciente:[],
                historial:'',
                fecha_inicio:'',
                fecha_final:'',
                id_especialidad:id_esp,
            
                list_paciente_f:''
                
            }),
            mounted(){
                fetch(this.url+'/internaciones/Vue_Paciente_all')
                .then(res => res.json())
                .then(data => { 
                
                    for (var i = 0; i < data.length; i++){
                        this.lista_paciente.push({
                            name: data[i].nombre+' '+data[i].apellidop+' '+data[i].apellidom,
                            historial: data[i].numeroHistorial
                            
                        })
                    }
                    
                })
            },
            methods:{
                buscar(){
                    var data_body = {
                        historial: this.historial.historial,
                        fecha_inicio: this.fecha_inicio,
                        fecha_final: this.fecha_final
                    };
                    var esto = {
                        method: 'POST',
                        body: JSON.stringify(data_body),
                        headers:{
                          'Content-type' : "application/json"
                        }
                    };
                    fetch(this.url+'/internaciones/Vue_filter_fechas_altas/'+this.id_especialidad, esto)
                    .then(res => res.json())
                    .catch(error => console.error('Error:', error))
                    .then(data => { 
                        if (data.success == false){
                            swal.fire(
                              'Error!',
                              '<label style="color:red;">'+data.msg+'</label>',
                              'error'
                            )
                        }else{
                            this.list_paciente_f = data
                        }
                    
                    })
                }
            }
        
        })
    </script>
</body>